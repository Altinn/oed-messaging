<?xml version="1.0" encoding="utf-8"?>
<xacml:Policy xmlns:xsl="http://www.w3.org/2001/XMLSchema-instance" xmlns:xacml="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="urn:altinn:example:policyid:correspondance" Version="1.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides">
	<xacml:Target/>
	
	<xacml:Rule RuleId="urn:altinn:example:ruleid:privateperson-read" Effect="Permit">
		<xacml:Description>A rule giving private persons read access to altinn.oed.correspondance messaging service</xacml:Description>
		<xacml:Target>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PrivatePerson</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:partytype" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">digdir</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:org" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">oed-correspondence</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:app" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
		</xacml:Target>
	</xacml:Rule>

	<xacml:Rule RuleId="urn:altinn:example:ruleid:altinn-correspondance-sender" Effect="Permit">
		<xacml:Description>A rule giving altinn organization (correspondence sender) full access (instantiate, read, write, delete) to altinn.oed.correspondance messaging service</xacml:Description>
		<xacml:Target>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">digdir</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:org" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">digdir</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:org" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">oed-correspondence</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:altinn:app" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
			<xacml:AnyOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">instantiate</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">delete</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
				<xacml:AllOf>
					<xacml:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">send</xacml:AttributeValue>
						<xacml:AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
					</xacml:Match>
				</xacml:AllOf>
			</xacml:AnyOf>
		</xacml:Target>
	</xacml:Rule>
	
	<xacml:ObligationExpressions>
		<xacml:ObligationExpression FulfillOn="Permit" ObligationId="urn:altinn:obligation:authenticationLevel4">
			<xacml:AttributeAssignmentExpression AttributeId="urn:altinn:obligation1-assignment1" Category="urn:altinn:minimum-authenticationlevel">
				<xacml:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">1</xacml:AttributeValue>
			</xacml:AttributeAssignmentExpression>
		</xacml:ObligationExpression>
	</xacml:ObligationExpressions>
</xacml:Policy>

